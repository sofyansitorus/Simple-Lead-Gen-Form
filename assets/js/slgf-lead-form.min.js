!function(e){"use strict";var a={init:function(){var a,r=this;e(document).on("keypress",".slgf-field",function(t){clearTimeout(a),a=setTimeout(function(){var a=e(t.currentTarget).closest("form"),l=e(t.currentTarget).attr("name");slgf_params.fields[l]&&(a.find("[name='"+l+"__label']").length&&(slgf_params.fields[l].label=a.find("[name='"+l+"__label']").val()),r.toggleFieldError(a,l,r.isFieldError(e(t.currentTarget).val(),slgf_params.fields[l])))},400)}),e(document).on("focusout",".slgf-field",function(a){var t=e(a.currentTarget).closest("form"),l=e(a.currentTarget).attr("name");slgf_params.fields[l]&&(t.find("[name='"+l+"__label']").length&&(slgf_params.fields[l].label=t.find("[name='"+l+"__label']").val()),r.toggleFieldError(t,l,r.isFieldError(e(a.currentTarget).val(),slgf_params.fields[l])))}),e("form.slgf-form").submit(function(a){a.preventDefault();var t=e(a.currentTarget),l={},s={},i=!1;t.find(".slgf-field-error").empty(),t.find(".slgf-alertbox").hide().removeClass("success error").empty(),e.each(t.serializeArray(),function(e,a){try{if(slgf_params.fields[a.name]&&(t.find("[name='"+a.name+"__label']").length&&(slgf_params.fields[a.name].label=t.find("[name='"+a.name+"__label']").val()),i=r.isFieldError(a.value,slgf_params.fields[a.name])))throw i;l[a.name]=a.value}catch(e){s[a.name]=e}}),Object.keys(s).length?e.each(s,function(e,a){r.toggleFieldError(t,e,a)}):Object.keys(l).length&&(t.find("button").addClass("is-loading").prop("disabled",!0),r.ajaxGetTime(l,t))})},isFieldError:function(e,a){var r=!1;try{if(a.required&&!e.length)throw a.label+" "+slgf_params.txt_err_required;switch(a.type){case"email":if(e.length&&!e.match(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/))throw a.label+" "+slgf_params.txt_err_invalid;break;case"number":if(e.length&&!e.match(/^[0-9]+$/))throw a.label+" "+slgf_params.txt_err_invalid}}catch(e){r=e}return r},toggleFieldError:function(e,a,r){r?e.find("[name='"+a+"']").next(".slgf-field-error").html(r).closest(".slgf-row").removeClass("valid").addClass("error"):e.find("[name='"+a+"']").next(".slgf-field-error").empty().closest(".slgf-row").removeClass("error").addClass("valid")},ajaxGetTime:function(a,r){var t=this;e.ajax({url:slgf_params.api_url,method:"GET",cache:!1,crossDomain:!0,success:function(e){try{if(void 0===e.data||void 0===e.data.datetime||void 0===e.data.datetime.date_time_txt)throw"Date time is undefined";a.current_date_time=e.data.datetime.date_time_txt,t.ajaxSubmit(a,r)}catch(e){t.ajaxSubmit(a,r)}},error:function(){t.ajaxSubmit(a,r)}})},ajaxSubmit:function(a,r){e.ajax({url:slgf_params.ajax_url,data:a,method:"POST",cache:!1,success:function(e,a){if(r.find("button").removeClass("is-loading").prop("disabled",!1),e.msg.length){var t=e.success?"success":"error";r.find(".slgf-alertbox").addClass(t).html(e.msg).show()}e.success&&r.find(".slgf-field").val(""),r.find(".slgf-row").removeClass("error valid")}})}};e(document).ready(function(){a.init()})}(jQuery);